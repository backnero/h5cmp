(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-70c6"],{"+BuQ":function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"e",function(){return a}),n.d(t,"c",function(){return o}),n.d(t,"d",function(){return s}),n.d(t,"a",function(){return u});var r=n("t3Un");function i(e){return Object(r.a)({url:"/apisix/admin/routes",method:"GET",params:e})}var a=function(e,t){return Object(r.a)({url:"/apisix/admin/routes/"+e,method:"PUT",data:t})},o=function(e){return Object(r.a)({url:"/apisix/admin/routes/"+e,method:"GET"})},s=function(e){return Object(r.a)({url:"/apisix/admin/routes/"+e,method:"DELETE"})},u=function(e){return Object(r.a)({url:"/apisix/admin/routes",method:"POST",data:e})}},"/f1G":function(e,t,n){e.exports={default:n("nhzr"),__esModule:!0}},"2bLA":function(e,t,n){},"4fRq":function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var i=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}},"7OfA":function(e,t,n){},"8gsd":function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"e",function(){return a}),n.d(t,"c",function(){return o}),n.d(t,"d",function(){return s}),n.d(t,"a",function(){return u});var r=n("t3Un");function i(e){return Object(r.a)({url:"/apisix/admin/services",method:"GET",params:e})}var a=function(e,t){return Object(r.a)({url:"/apisix/admin/services/"+e,method:"PUT",data:t})},o=function(e){return Object(r.a)({url:"/apisix/admin/services/"+e,method:"GET"})},s=function(e){return Object(r.a)({url:"/apisix/admin/services/"+e,method:"DELETE"})},u=function(e){return Object(r.a)({url:"/apisix/admin/services",method:"POST",data:e})}},E8gZ:function(e,t,n){var r=n("jmDH"),i=n("w6GO"),a=n("NsO/"),o=n("NV0k").f;e.exports=function(e){return function(t){for(var n,s=a(t),u=i(s),l=u.length,c=0,f=[];l>c;)n=u[c++],r&&!o.call(s,n)||f.push(e?[n,s[n]]:s[n]);return f}}},I2ZF:function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,i=n;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")}},LtZ2:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"e",function(){return a}),n.d(t,"c",function(){return o}),n.d(t,"a",function(){return s}),n.d(t,"d",function(){return u});var r=n("t3Un");function i(e){return Object(r.a)({url:"/apisix/admin/upstreams",method:"GET",params:e})}var a=function(e,t){return Object(r.a)({url:"/apisix/admin/upstreams/"+e,method:"PUT",data:t})},o=function(e){return Object(r.a)({url:"/apisix/admin/upstreams/"+e,method:"GET"})},s=function(e){return Object(r.a)({url:"/apisix/admin/upstreams",method:"post",data:e})},u=function(e){return Object(r.a)({url:"/apisix/admin/upstreams/"+e,method:"DELETE"})}},QLgv:function(e,t,n){"use strict";var r=n("2bLA");n.n(r).a},RPuQ:function(e,t,n){"use strict";n.r(t);var r=n("QbLZ"),i=n.n(r),a=n("GQeE"),o=n.n(a),s=n("EJiy"),u=n.n(s),l=n("sk9p"),c=n.n(l),f=n("oF3Q"),d=n.n(f),p=n("P2sY"),m=n.n(p),v=n("14Xm"),h=n.n(v),g=n("D3Ub"),b=n.n(g),_=n("yPmT"),x=n("/f1G"),w=n.n(x),k={name:"VarArgs",props:{pVars:{type:Array,default:[]}},data:function(){return{isFullscreen:!1,varNames:["remote_addr","host","uri","http_user_agent","http_referer","http_cookie","http_accept_language","request_uri","query_string","remote_port","hostname","arg_id"],varOperator:["==","~=",">","<","~~"]}},computed:{vars:function(){return this.pVars.map(function(e){var t=c()(e,3);return{name:t[0],operator:t[1],value:t[2]}})}},methods:{onChange:function(){var e=this.vars.map(function(e){return w()(e)});this.$emit("update:pVars",e)},addVar:function(){this.vars.push({name:null,operator:null,value:null}),this.onChange()},removeVar:function(e){var t=this;this.$confirm("Do you want to remove the var?","Warning",{confirmButtonText:"Confirm",cancelButtonText:"Cancel",type:"warning"}).then(b()(h.a.mark(function n(){return h.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:t.vars.splice(e,1),t.onChange();case 2:case"end":return n.stop()}},n,t)}))).catch(function(){})}}},P=(n("e96G"),n("KHd+")),y=Object(P.a)(k,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-form",[e._l(e.vars,function(t,r){return n("el-form-item",{key:r,staticClass:"var-item",attrs:{label:"Var"+(r+1)}},[n("el-form-item",{attrs:{prop:"var."+r+".ip"}},[n("el-select",{attrs:{placeholder:"输入值后并回车",filterable:"","allow-create":"","default-first-option":""},on:{change:e.onChange},model:{value:t.name,callback:function(n){e.$set(t,"name",n)},expression:"item.name"}},e._l(e.varNames,function(e){return n("el-option",{key:e,attrs:{label:e,value:e}})})),e._v(" "),n("el-select",{attrs:{placeholder:"Operator"},on:{change:e.onChange},model:{value:t.operator,callback:function(n){e.$set(t,"operator",n)},expression:"item.operator"}},e._l(e.varOperator,function(e){return n("el-option",{key:e,attrs:{label:e,value:e}})}))],1),e._v(" "),n("el-form-item",[n("el-input",{attrs:{placeholder:""},on:{input:e.onChange},model:{value:t.value,callback:function(n){e.$set(t,"value",n)},expression:"item.value"}})],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"danger"},on:{click:function(t){t.preventDefault(),e.removeVar(r)}}},[e._v("删除")])],1)],1)}),e._v(" "),n("el-form-item",[n("el-button",{on:{click:e.addVar}},[e._v("添加 Var")])],1)],2)},[],!1,null,"dbdfc514",null);y.options.__file="index.vue";var O=y.exports,E=n("+BuQ"),j=n("RovF"),L=n("LtZ2"),$=n("8gsd"),D={components:{PluginDialog:_.a,VarArgs:O},data:function(){return{form:{uris:[],hosts:[],remote_addr:"",upstream_id:"",service_id:"",methods:[],plugins:{},vars:[],desc:"",filter_func:""},ExistedUris:[{}],ExistedHosts:[{}],validateFilterFuncRegexp:/^function\(\)[^]*?\bend$/,rules:{uris:{required:!0},filter_func:[{pattern:this.validateFilterFuncRegexp,trigger:"blur",message:"用户自定义的过滤函数，以‘function()’开头，以‘end’结尾。"}]},isEditMode:!1,methods:["GET","POST","PUT","DELETE","PATCH","HEAD","OPTIONS"],pluginList:[],pluginName:"",showPluginDialog:!1,upstreamList:[],serviceList:[]}},watch:{},computed:{filteredPluginList:function(){var e=this;return this.pluginList.filter(function(t){return!e.form.plugins.hasOwnProperty(t)})}},methods:{reset:function(){this.form={uris:[],hosts:[],remote_addr:"",upstream_id:"",service_id:"",methods:[],plugins:{},vars:[],desc:"",filter_func:""}},filterDataWithRegex:function(e,t){if(e.length>0){var n=[];e.filter(function(e){"string"==typeof e&&(e=e.replace(/\s+/g,""),t.test(e)&&n.push(e))}),n.map(function(t,n){e[n]=t}),e.length>n.length&&e.splice(n.length,e.length)}},filterUriOptions:function(e){this.filterDataWithRegex(e,new RegExp("^([\\*\\./0-9a-zA-Z-_~@\\?\\!#$\\(\\)]+)$"))},getData:function(){var e=this;return b()(h.a.mark(function t(){var n,r,i,a,o,s,u,l,c,f,d,p,m,v,g,b,_,x,w,k,P,y,O,j,L,$,D;return h.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.$route.params.id,t.next=3,Object(E.c)(n);case 3:r=t.sent,i=r.node.value,a=i.uri,o=void 0===a?"":a,s=i.uris,u=void 0===s?[]:s,l=i.hosts,c=void 0===l?[]:l,f=i.host,d=void 0===f?"":f,p=i.remote_addr,m=void 0===p?"":p,v=i.upstream_id,g=void 0===v?"":v,b=i.service_id,_=void 0===b?"":b,x=i.methods,w=void 0===x?[]:x,k=i.plugins,P=void 0===k?{}:k,y=i.vars,O=void 0===y?[]:y,j=i.desc,L=void 0===j?"":j,$=i.filter_func,D=void 0===$?"":$,0===c.length&&d.length>0&&c.push(d),0===u.length&&o.length>0&&u.push(o),e.form={uris:u,hosts:c,remote_addr:m,upstream_id:g,service_id:_,methods:w,plugins:P,vars:O,desc:L,filter_func:D};case 32:case"end":return t.stop()}},t,e)}))()},onSubmit:function(){var e=this;return b()(h.a.mark(function t(){return h.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.$refs.form.validate(function(){var t=b()(h.a.mark(function t(n,r){var i;return h.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=16;break}if((i=m()({},e.form)).methods.length||delete i.methods,d()(i).forEach(function(e){var t=c()(e,2),n=t[0],r=t[1];"object"===u()(i[n])?"plugins"!==n&&0===o()(r).length&&delete i[n]:""===r&&delete i[n]}),delete i.tempPlugin,!e.isEditMode){t.next=10;break}return t.next=8,Object(E.e)(e.$route.params.id,i);case 8:t.next=12;break;case 10:return t.next=12,Object(E.a)(i);case 12:e.$message.success((e.isEditMode?"Update the":"Create a")+" service successfully!"),e.isEditMode||e.$nextTick(function(){e.$router.push({name:"GatewayRoutesList"})}),t.next=18;break;case 16:return r.filter_func&&e.$message.warning(r.filter_func[0].message),t.abrupt("return",!1);case 18:case"end":return t.stop()}},t,e)}));return function(e,n){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}},t,e)}))()},toPreviousPage:function(){this.$router.go(-1)},getUpstreamList:function(){var e=this;return b()(h.a.mark(function t(){var n,r,a;return h.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(L.b)();case 2:n=t.sent,r=n.node.nodes,a=void 0===r?[]:r,e.upstreamList=a.map(function(e){var t=e.key.match(/\/([0-9]+)/)[1];return i()({},e.value,{id:t})});case 6:case"end":return t.stop()}},t,e)}))()},getServiceList:function(){var e=this;return b()(h.a.mark(function t(){var n,r,a;return h.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object($.b)();case 2:n=t.sent,r=n.node.nodes,a=void 0===r?[]:r,e.serviceList=a.map(function(e){var t=e.key.match(/\/([0-9]+)/)[1];return i()({},e.value,{id:t})});case 6:case"end":return t.stop()}},t,e)}))()},getPluginList:function(){var e=this;return b()(h.a.mark(function t(){var n;return h.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(j.a)();case 2:n=t.sent,e.pluginList=n;case 4:case"end":return t.stop()}},t,e)}))()},showPlugin:function(e){var t=this;return b()(h.a.mark(function n(){return h.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:t.pluginName=e,t.showPluginDialog=!0;case 2:case"end":return n.stop()}},n,t)}))()},onPluginSave:function(e,t){delete this.form.plugins.tempPlugin,this.showPluginDialog=!1,this.form.plugins[e]=t},onHidePlugin:function(e){this.showPluginDialog=!1,delete this.form.plugins.tempPlugin},addPlugin:function(){var e=this;return b()(h.a.mark(function t(){return h.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.form.plugins.hasOwnProperty("tempPlugin")){t.next=2;break}return t.abrupt("return");case 2:e.form.plugins=i()({},e.form.plugins,{tempPlugin:null});case 3:case"end":return t.stop()}},t,e)}))()},cancelAddPlugin:function(){var e=this;return b()(h.a.mark(function t(){return h.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:delete e.form.plugins.tempPlugin,e.$forceUpdate();case 2:case"end":return t.stop()}},t,e)}))()},removePlugin:function(e){var t=this;this.$confirm("Do you want to remove "+e+" plugin?","Warning",{confirmButtonText:"Confirm",cancelButtonText:"Cancel",type:"warning"}).then(b()(h.a.mark(function n(){return h.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:t.$delete(t.form.plugins,e);case 1:case"end":return n.stop()}},n,t)}))).catch(function(){})},onVarArgsChange:function(e){this.form.vars=e}},created:function(){this.isEditMode=-1===this.$route.name.indexOf("GatewayRoutesCreate"),this.isEditMode&&this.getData(),this.getPluginList(),this.getUpstreamList(),this.getServiceList()}},T=(n("QLgv"),Object(P.a)(D,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[n("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px","show-message":!1}},[n("el-form-item",{attrs:{label:"Desc"}},[n("el-input",{attrs:{placeholder:"Description"},model:{value:e.form.desc,callback:function(t){e.$set(e.form,"desc",t)},expression:"form.desc"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"URIs",prop:"uris"}},[n("el-select",{attrs:{"allow-create":"",filterable:"",multiple:"","default-first-option":"",placeholder:"输入值后并回车"},on:{change:e.filterUriOptions},model:{value:e.form.uris,callback:function(t){e.$set(e.form,"uris",t)},expression:"form.uris"}},e._l(e.ExistedUris,function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),n("el-form-item",{attrs:{label:"Hosts",prop:"hosts",placeholder:"Hosts"}},[n("el-select",{attrs:{multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"输入值后并回车"},model:{value:e.form.hosts,callback:function(t){e.$set(e.form,"hosts",t)},expression:"form.hosts"}},e._l(e.ExistedHosts,function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),n("p",{staticClass:"tip"},[e._v("任何值均可")])],1),e._v(" "),n("el-form-item",{attrs:{label:"Remote Address",prop:"remote_addr"}},[n("el-input",{attrs:{placeholder:"Remote Address"},model:{value:e.form.remote_addr,callback:function(t){e.$set(e.form,"remote_addr",t)},expression:"form.remote_addr"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"Methods"}},[n("el-select",{attrs:{multiple:"",placeholder:"Methods"},model:{value:e.form.methods,callback:function(t){e.$set(e.form,"methods",t)},expression:"form.methods"}},e._l(e.methods,function(e){return n("el-option",{key:e,attrs:{label:e,value:e}})}))],1),e._v(" "),n("el-form-item",{attrs:{label:"Upstream",prop:"upstream_id"}},[n("el-select",{attrs:{placeholder:"Upstream",clearable:"",filterable:""},model:{value:e.form.upstream_id,callback:function(t){e.$set(e.form,"upstream_id",t)},expression:"form.upstream_id"}},e._l(e.upstreamList,function(e){return n("el-option",{key:e.id,attrs:{label:e.desc,value:e.id}})}))],1),e._v(" "),n("el-form-item",{attrs:{label:"Service",prop:"service_id"}},[n("el-select",{attrs:{placeholder:"Service",clearable:"",filterable:""},model:{value:e.form.service_id,callback:function(t){e.$set(e.form,"service_id",t)},expression:"form.service_id"}},e._l(e.serviceList,function(e){return n("el-option",{key:e.id,attrs:{label:e.desc,value:e.id}})}))],1),e._v(" "),e._l(e.form.plugins,function(t,r,i){return n("el-form-item",{key:r,staticClass:"plugin-item",attrs:{label:"plugin-"+i}},["tempPlugin"!==r?n("el-button",{attrs:{type:"info",plain:""},on:{click:function(t){e.showPlugin(r)}}},[e._v(e._s(r))]):e._e(),e._v(" "),"tempPlugin"!==r?n("el-button",{attrs:{type:"danger"},on:{click:function(t){t.preventDefault(),e.removePlugin(r)}}},[e._v("删除")]):e._e(),e._v(" "),"tempPlugin"===r?n("el-select",{staticClass:"plugin-select",attrs:{value:null,placeholder:"Select a Plugin",filterable:""},on:{change:e.showPlugin}},e._l(e.filteredPluginList,function(e){return n("el-option",{key:e,attrs:{label:e,value:e}})})):e._e(),e._v(" "),"tempPlugin"===r?n("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"danger"},on:{click:e.cancelAddPlugin}},[e._v("取消")]):e._e()],1)}),e._v(" "),n("el-form-item",[n("el-button",{attrs:{disabled:!(e.filteredPluginList.length&&!e.form.plugins.hasOwnProperty("tempPlugin"))},on:{click:e.addPlugin}},[e._v("添加 Plugin")])],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("保存")]),e._v(" "),n("el-button",{on:{click:e.toPreviousPage}},[e._v("取消")])],1)],2),e._v(" "),n("PluginDialog",{attrs:{show:e.showPluginDialog,name:e.pluginName,"plugin-data":e.form.plugins[e.pluginName]},on:{hidePlugin:function(t){e.onHidePlugin(e.pluginName)},save:e.onPluginSave}})],1)},[],!1,null,"72f017e2",null));T.options.__file="edit.vue";t.default=T.exports},RovF:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n("t3Un"),i=function(){return Object(r.a)({url:"/apisix/admin/plugins/list",method:"get"})}},SIrY:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n("t3Un"),i=function(e){return Object(r.a)({url:"/apisix/admin/schema/plugins/"+e,method:"get"})}},e96G:function(e,t,n){"use strict";var r=n("7OfA");n.n(r).a},fW1p:function(e,t,n){var r=n("Y7ZC"),i=n("E8gZ")(!1);r(r.S,"Object",{values:function(e){return i(e)}})},nGDx:function(e,t,n){var r=n("Y7ZC"),i=n("E8gZ")(!0);r(r.S,"Object",{entries:function(e){return i(e)}})},nhzr:function(e,t,n){n("fW1p"),e.exports=n("WEpk").Object.values},oF3Q:function(e,t,n){e.exports={default:n("tgZa"),__esModule:!0}},tgZa:function(e,t,n){n("nGDx"),e.exports=n("WEpk").Object.entries},xDdU:function(e,t,n){var r,i,a=n("4fRq"),o=n("I2ZF"),s=0,u=0;e.exports=function(e,t,n){var l=t&&n||0,c=t||[],f=(e=e||{}).node||r,d=void 0!==e.clockseq?e.clockseq:i;if(null==f||null==d){var p=a();null==f&&(f=r=[1|p[0],p[1],p[2],p[3],p[4],p[5]]),null==d&&(d=i=16383&(p[6]<<8|p[7]))}var m=void 0!==e.msecs?e.msecs:(new Date).getTime(),v=void 0!==e.nsecs?e.nsecs:u+1,h=m-s+(v-u)/1e4;if(h<0&&void 0===e.clockseq&&(d=d+1&16383),(h<0||m>s)&&void 0===e.nsecs&&(v=0),v>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=m,u=v,i=d;var g=(1e4*(268435455&(m+=122192928e5))+v)%4294967296;c[l++]=g>>>24&255,c[l++]=g>>>16&255,c[l++]=g>>>8&255,c[l++]=255&g;var b=m/4294967296*1e4&268435455;c[l++]=b>>>8&255,c[l++]=255&b,c[l++]=b>>>24&15|16,c[l++]=b>>>16&255,c[l++]=d>>>8|128,c[l++]=255&d;for(var _=0;_<6;++_)c[l+_]=f[_];return t||o(c)}}}]);