(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-1d7c"],{"4F/e":function(e,n,t){},"4fRq":function(e,n){var t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(t){var r=new Uint8Array(16);e.exports=function(){return t(r),r}}else{var i=new Array(16);e.exports=function(){for(var e,n=0;n<16;n++)0==(3&n)&&(e=4294967296*Math.random()),i[n]=e>>>((3&n)<<3)&255;return i}}},E8gZ:function(e,n,t){var r=t("jmDH"),i=t("w6GO"),u=t("NsO/"),o=t("NV0k").f;e.exports=function(e){return function(n){for(var t,a=u(n),s=i(a),c=s.length,l=0,f=[];c>l;)t=s[l++],r&&!o.call(a,t)||f.push(e?[t,a[t]]:a[t]);return f}}},I2ZF:function(e,n){for(var t=[],r=0;r<256;++r)t[r]=(r+256).toString(16).substr(1);e.exports=function(e,n){var r=n||0,i=t;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")}},RovF:function(e,n,t){"use strict";t.d(n,"a",function(){return i});var r=t("t3Un"),i=function(){return Object(r.a)({url:"/apisix/admin/plugins/list",method:"get"})}},SIrY:function(e,n,t){"use strict";t.d(n,"a",function(){return i});var r=t("t3Un"),i=function(e){return Object(r.a)({url:"/apisix/admin/schema/plugins/"+e,method:"get"})}},"V+dt":function(e,n,t){"use strict";var r=t("4F/e");t.n(r).a},"bZy+":function(e,n,t){"use strict";t.r(n);var r=t("GQeE"),i=t.n(r),u=t("EJiy"),o=t.n(u),a=t("sk9p"),s=t.n(a),c=t("oF3Q"),l=t.n(c),f=t("P2sY"),m=t.n(f),p=t("QbLZ"),d=t.n(p),g=t("14Xm"),v=t.n(g),h=t("D3Ub"),w=t.n(h),b=t("p/22"),P=t("RovF"),x={name:"ConsumerEdit",components:{PluginDialog:t("yPmT").a},computed:{filteredPluginList:function(){var e=this;return this.pluginList.filter(function(n){return!e.form.plugins.hasOwnProperty(n)})}},data:function(){return{isEditMode:!1,form:{username:"",plugins:{},desc:""},rules:{username:{required:!0}},pluginList:[],pluginName:"",showPluginDialog:!1}},methods:{getConsumerData:function(){var e=this;return w()(v.a.mark(function n(){var t,r,i;return v.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.$route.params.username,n.next=3,Object(b.b)(t);case 3:r=n.sent,i=r,e.form={desc:i.node.value.desc,username:t,plugins:i.node.value.plugins};case 6:case"end":return n.stop()}},n,e)}))()},getPluginList:function(){var e=this;return w()(v.a.mark(function n(){var t;return v.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(P.a)();case 2:t=n.sent,e.pluginList=t;case 4:case"end":return n.stop()}},n,e)}))()},addPlugin:function(){var e=this;return w()(v.a.mark(function n(){return v.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.form.plugins.hasOwnProperty("tempPlugin")){n.next=2;break}return n.abrupt("return");case 2:e.form.plugins=d()({},e.form.plugins,{tempPlugin:null});case 3:case"end":return n.stop()}},n,e)}))()},onSubmit:function(){var e=this;return w()(v.a.mark(function n(){return v.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:e.$refs.form.validate(function(){var n=w()(v.a.mark(function n(t){var r;return v.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t){n.next=13;break}return delete e.form.plugins.tempPlugin,r=m()({},e.form),l()(r).forEach(function(e){var n=s()(e,2),t=n[0],u=n[1];"object"===o()(r[t])?"plugins"!==t&&0===i()(u).length&&delete r[t]:""===u&&delete r[t]}),n.next=6,Object(b.d)(m()({},r));case 6:if(e.$message.success((e.isEditMode?"Update the":"Create a")+" consumer successfully!"),!e.isEditMode){n.next=9;break}return n.abrupt("return");case 9:TagsViewModule.delView(e.$route),e.$nextTick(function(){e.$router.push({name:"GatewayConsumersList"})}),n.next=14;break;case 13:return n.abrupt("return",!1);case 14:case"end":return n.stop()}},n,e)}));return function(e){return n.apply(this,arguments)}}());case 1:case"end":return n.stop()}},n,e)}))()},showPlugin:function(e){var n=this;return w()(v.a.mark(function t(){return v.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n.pluginName=e,n.showPluginDialog=!0;case 2:case"end":return t.stop()}},t,n)}))()},onPluginSave:function(e,n){delete this.form.plugins.tempPlugin,this.showPluginDialog=!1,this.form.plugins[e]=n},toPreviousPage:function(){this.$router.go(-1)},removePlugin:function(e){var n=this;this.$confirm("Do you want to remove "+e+" plugin?","Warning",{confirmButtonText:"Confirm",cancelButtonText:"Cancel",type:"warning"}).then(w()(v.a.mark(function t(){return v.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n.$delete(n.form.plugins,e);case 1:case"end":return t.stop()}},t,n)}))).catch(function(){})}},created:function(){this.isEditMode=-1===this.$route.name.indexOf("GatewayConsumersCreate"),this.isEditMode&&this.getConsumerData(),this.getPluginList()}},k=(t("V+dt"),t("KHd+")),y=Object(k.a)(x,function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"consumers-wrapper"},[t("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px","show-message":!1}},[t("el-form-item",{attrs:{label:"Desc"}},[t("el-input",{attrs:{placeholder:"Description"},model:{value:e.form.desc,callback:function(n){e.$set(e.form,"desc",n)},expression:"form.desc"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"name",prop:"username"}},[t("el-input",{model:{value:e.form.username,callback:function(n){e.$set(e.form,"username",n)},expression:"form.username"}})],1),e._v(" "),e._l(e.form.plugins,function(n,r){return t("el-form-item",{key:r,staticClass:"plugin-item",attrs:{label:"plugin"}},["tempPlugin"!==r?t("el-button",{attrs:{type:"info",plain:""},on:{click:function(n){e.showPlugin(r)}}},[e._v(e._s(r))]):e._e(),e._v(" "),"tempPlugin"!==r?t("el-button",{attrs:{type:"danger"},on:{click:function(n){n.preventDefault(),e.removePlugin(r)}}},[e._v("删除")]):e._e(),e._v(" "),"tempPlugin"===r?t("el-select",{staticClass:"plugin-select",attrs:{value:null,placeholder:"Select a Plugin"},on:{change:e.showPlugin}},e._l(e.filteredPluginList,function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})})):e._e()],1)}),e._v(" "),t("el-form-item",[t("el-button",{attrs:{disabled:!e.filteredPluginList.length},on:{click:e.addPlugin}},[e._v("添加 Plugin")])],1),e._v(" "),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("保存")]),e._v(" "),t("el-button",{on:{click:e.toPreviousPage}},[e._v("取消")])],1)],2),e._v(" "),t("PluginDialog",{attrs:{show:e.showPluginDialog,name:e.pluginName,"plugin-data":e.form.plugins[e.pluginName]},on:{hidePlugin:function(n){e.showPluginDialog=!1},save:e.onPluginSave}})],1)},[],!1,null,"7afaf987",null);y.options.__file="edit.vue";n.default=y.exports},nGDx:function(e,n,t){var r=t("Y7ZC"),i=t("E8gZ")(!0);r(r.S,"Object",{entries:function(e){return i(e)}})},oF3Q:function(e,n,t){e.exports={default:t("tgZa"),__esModule:!0}},"p/22":function(e,n,t){"use strict";t.d(n,"a",function(){return i}),t.d(n,"c",function(){return u}),t.d(n,"b",function(){return o}),t.d(n,"d",function(){return a});var r=t("t3Un");function i(e){return Object(r.a)({url:"/apisix/admin/consumers",method:"GET",params:e})}var u=function(e){return Object(r.a)({url:"/apisix/admin/consumers/"+e,method:"DELETE"})},o=function(e){return Object(r.a)({url:"/apisix/admin/consumers/"+e,method:"GET"})},a=function(e){return Object(r.a)({url:"/apisix/admin/consumers",method:"PUT",data:e})}},tgZa:function(e,n,t){t("nGDx"),e.exports=t("WEpk").Object.entries},xDdU:function(e,n,t){var r,i,u=t("4fRq"),o=t("I2ZF"),a=0,s=0;e.exports=function(e,n,t){var c=n&&t||0,l=n||[],f=(e=e||{}).node||r,m=void 0!==e.clockseq?e.clockseq:i;if(null==f||null==m){var p=u();null==f&&(f=r=[1|p[0],p[1],p[2],p[3],p[4],p[5]]),null==m&&(m=i=16383&(p[6]<<8|p[7]))}var d=void 0!==e.msecs?e.msecs:(new Date).getTime(),g=void 0!==e.nsecs?e.nsecs:s+1,v=d-a+(g-s)/1e4;if(v<0&&void 0===e.clockseq&&(m=m+1&16383),(v<0||d>a)&&void 0===e.nsecs&&(g=0),g>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=d,s=g,i=m;var h=(1e4*(268435455&(d+=122192928e5))+g)%4294967296;l[c++]=h>>>24&255,l[c++]=h>>>16&255,l[c++]=h>>>8&255,l[c++]=255&h;var w=d/4294967296*1e4&268435455;l[c++]=w>>>8&255,l[c++]=255&w,l[c++]=w>>>24&15|16,l[c++]=w>>>16&255,l[c++]=m>>>8|128,l[c++]=255&m;for(var b=0;b<6;++b)l[c+b]=f[b];return n||o(l)}}}]);